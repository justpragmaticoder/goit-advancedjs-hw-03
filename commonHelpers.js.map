{"version":3,"file":"commonHelpers.js","sources":["../src/js/request-helper.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"https://api.thecatapi.com/v1\";\nconst BREEDS_API_ENDPOINT = `${BASE_URL}/breeds`;\nconst IMAGES_API_ENDPOINT = `${BASE_URL}/images/search?`;\nconst API_KEY_HEADER = \"x-api-key\";\nconst BREEDS_CACHE_KEY = \"cat_breeds\";\nconst CAT_BY_BREED_CACHE_KEY = \"cat_by_breed\";\nconst CAT_API_KEY = process.env.CAT_API_KEY;\n/* I've tried to hide it on GitHub pages build, but have no success. Don't want to dive deeply into it. Sorry */\nconst DEFAULT_CAT_API_KEY =\n  \"live_bytNC2cujaqiVi4NMgtPCYmpdjwwzI4YqMM94fNkWsEQBwt71pQFtm3yT5u5YsHM\";\n\nfunction fetchBreeds() {\n  const rawCachedCatBreeds = localStorage.getItem(BREEDS_CACHE_KEY);\n\n  if (rawCachedCatBreeds) {\n    const parsedData = JSON.parse(rawCachedCatBreeds);\n    console.log(\"[fetchBreeds] cachedCatBreeds: \", parsedData);\n    return JSON.parse(parsedData);\n  }\n\n  console.log(\"Does CAT_API_KEY exist: \", !!CAT_API_KEY);\n\n  const apiKey = CAT_API_KEY ?? DEFAULT_CAT_API_KEY;\n\n  return axios\n    .get(`${BREEDS_API_ENDPOINT}`, {\n      headers: {\n        API_KEY_HEADER: apiKey,\n      },\n    })\n    .then((response) => {\n      localStorage.setItem(BREEDS_CACHE_KEY, JSON.stringify(response.data));\n      console.log(\"[fetchBreeds] response: \", response);\n      return response.data;\n    });\n}\n\nfunction fetchCatByBreed(breedId) {\n  const rawCachedCatByBreed = localStorage.getItem(CAT_BY_BREED_CACHE_KEY);\n\n  if (rawCachedCatByBreed) {\n    const parsedData = JSON.parse(rawCachedCatByBreed);\n    console.log(\"[fetchCatByBreed] cachedCatByBreed: \", parsedData);\n    return JSON.parse(parsedData);\n  }\n\n  console.log(\"Does CAT_API_KEY exist: \", !!CAT_API_KEY);\n\n  const apiKey = CAT_API_KEY ?? DEFAULT_CAT_API_KEY;\n\n  return axios\n    .get(`${IMAGES_API_ENDPOINT}breed_ids=${breedId}`, {\n      headers: {\n        API_KEY_HEADER: apiKey,\n      },\n    })\n    .then((response) => {\n      localStorage.setItem(\n        CAT_BY_BREED_CACHE_KEY,\n        JSON.stringify(response.data)\n      );\n      console.log(\"[fetchCatByBreed] response: \", response);\n      return response.data;\n    });\n}\n\nexport { fetchBreeds, fetchCatByBreed };\n","import SlimSelect from \"slim-select\";\nimport \"slim-select/styles\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchBreeds, fetchCatByBreed } from \"./request-helper.js\";\n\nfunction toggleHiddenCompletely(element, isVisible) {\n  element.classList.toggle(\"is-hidden-compeletely\", !isVisible);\n}\n\nfunction selectorUpload(selector, loader, catDescription) {\n  fetchBreeds()\n    .then(function (breeds) {\n      selector.classList.remove(\"is-invisible\");\n      const slimSelector = breeds.map(\n        ({ id, name }) => `<option value=\"${id}\">${name}</option>`\n      );\n      selector.insertAdjacentHTML(\"afterbegin\", slimSelector.join(\"\"));\n      new SlimSelect({\n        select: selector,\n      });\n    })\n    .catch(function (error) {\n      handleError(error);\n    })\n    .finally(function () {\n      toggleHiddenCompletely(selector, true);\n      toggleHiddenCompletely(loader, false);\n      toggleHiddenCompletely(catDescription, true);\n    });\n}\n\nfunction createMarkup(event, selector, loader, catDescription) {\n  toggleHiddenCompletely(catDescription, false);\n  toggleHiddenCompletely(loader, true);\n  toggleHiddenCompletely(selector, true);\n\n  const breedId = event.currentTarget.value;\n\n  fetchCatByBreed(breedId)\n    .then(function (catData) {\n      console.log(\"catData: \", catData);\n\n      if (catData.length === 0) {\n        catDescription.innerHTML = ``;\n        return;\n      }\n      let { url, breeds } = catData[0];\n\n      catDescription.innerHTML = `\n        <img src=\"${url}\" alt=\"${breeds[0].name}\" width=\"400\" loading=\"lazy\" />\n        <div class=\"text-box\">\n          <h2>${breeds[0].name}</h2>\n          <p>${breeds[0].description}</p>\n          <p><b>Temperament: </b>${breeds[0].temperament}</p>\n          <p><b>Origin: </b>${breeds[0].origin}</p>\n        </div>`;\n    })\n    .catch(function (error) {\n      handleError(error);\n    })\n    .finally(function () {\n      toggleHiddenCompletely(loader, false);\n      toggleHiddenCompletely(selector, true);\n      toggleHiddenCompletely(catDescription, true);\n    });\n}\n\nfunction handleError(error) {\n  iziToast.error({\n    title: \"ðŸ”» Oops!\",\n    message: error.message ?? \"Something went wrong!\",\n    position: \"topCenter\",\n  });\n}\n\n(() => {\n  const selector = document.querySelector(\".breed-select\");\n  const loader = document.querySelector(\".loader\");\n  const catDescription = document.querySelector(\".cat-description\");\n\n  selector.addEventListener(\"change\", (event) =>\n    createMarkup(event, selector, loader, catDescription)\n  );\n  selectorUpload(selector, loader, catDescription);\n})();\n"],"names":["BASE_URL","BREEDS_API_ENDPOINT","IMAGES_API_ENDPOINT","BREEDS_CACHE_KEY","CAT_BY_BREED_CACHE_KEY","CAT_API_KEY","DEFAULT_CAT_API_KEY","fetchBreeds","rawCachedCatBreeds","parsedData","apiKey","axios","response","fetchCatByBreed","breedId","rawCachedCatByBreed","toggleHiddenCompletely","element","isVisible","selectorUpload","selector","loader","catDescription","breeds","slimSelector","id","name","SlimSelect","error","handleError","createMarkup","event","catData","url","iziToast"],"mappings":"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"}